import csv
import os
from tkinter import filedialog

file_load = filedialog.askopenfilename(initialdir=os.path.abspath(os.curdir),
                                       title="Incarcati fisierul cu informatiile sursa:")
with open(file_load, newline='') as csvfile:
    array_apfr = list(csv.reader(csvfile, delimiter='\t'))

array_delete = [
['\x0c+===================================================================================================================================+'],
['+===================================================================================================================================+'],
['|===================================================================================================================================|'],
['| product number    :    0000000000000     - 9999999999999                                                                          |'],
['|===================================================================================================================================|'],
['|external number               product number                      designation                                                      |'],
['|ressource group          designation ressource group                    total   unit                                               |'],
['|===================================================================================================================================|'],
[]
]
array_output = [["Client PN", "Leoni PN", "Designation", "Resource group", "Resignation resource group", "Total", "Unit"]]
array_curatat = [line for line in array_apfr if line not in array_delete]
array_curatat2 = [line for line in array_curatat if "" not in line]
array_curatat3 = [line for line in array_curatat2 if 'FAVLS' not in line[0]]

array_breakers = []
for i in range(len(array_curatat3)):
    if array_curatat3[i] == ['+-----------------------------------------------------------------------------------------------------------------------------------+']:
        array_breakers.append(i)

for i in range(0, 100):#len(array_breakers) - 1):
    array_output_temp = []
    for x in range(array_breakers[i] + 1, array_breakers[i + 1]-1):
        array_output_temp.append(array_curatat3[x])
    clientpn = [s.strip() for s in array_output_temp[0][0].split("   ") if s][0]
    leonipn = [s.strip() for s in array_output_temp[0][0].split("   ") if s][1]
    designation = [s.strip() for s in array_output_temp[0][0].split("   ") if s][2]
    first_three = [clientpn, leonipn, designation]
    for lista in array_output_temp[1:]:
        item_temp_list = [s.strip() for s in lista[0].split("   ") if s]
        merged_list = [x for x in first_three] + [x for x in item_temp_list]
        array_output.append(merged_list)
lista_rg = []
for p in array_output:
    if p[3] not in lista_rg:
        lista_rg.append(p[3])
print(lista_rg)




#for i in range(0, 50):
#    print(array_output[i])



lista_calcul = [["LHD801181.25433-0314", "X6499.1A1", "X6407.1A1", "X6478.1A1"],
                        ["LHD801181.25433-0315", "X6302.1A1", "X4556.1A1"],
                        ["LHD801181.25433-6095", "X6302.1A1", "X4556.1A1"],
                        ["LHD801181.25433-0316", "X6491.1A1", "X6492.1A1", "X7042.1A1", "X7043.1A1"],
                        ["LHD801181.25433-6096", "X6491.1A1", "X6492.1A1", "X7042.1A1", "X7043.1A1"],
                        ["RHD801181.25433-0313", "X6499.1A1", "X6407.1A1", "X6478.1A1", "X6302.1A1", "X4556.1A1"],
                        ["RHD801181.25433-0315", "X6491.1A1", "X6492.1A1", "X7042.1A1", "X7043.1A1"],
                        ["RHD801181.25433-6095", "X6491.1A1", "X6492.1A1", "X7042.1A1", "X7043.1A1"],
                        ["LHD801281.25433-0314", "X6499.1A1", "X6407.1A1", "X6478.1A1"],
                        ["LHD801281.25433-0315", "X6302.1A1", "X4556.1A1"],
                        ["LHD801281.25433-6095", "X6302.1A1", "X4556.1A1"],
                        ["LHD801281.25433-0316", "X6491.1A1", "X6492.1A1", "X7042.1A1", "X7043.1A1"],
                        ["LHD801281.25433-6096", "X6491.1A1", "X6492.1A1", "X7042.1A1", "X7043.1A1"],
                        ["RHD801281.25433-0313", "X6499.1A1", "X6407.1A1", "X6478.1A1", "X6302.1A1", "X4556.1A1"],
                        ["RHD801281.25433-0315", "X6491.1A1", "X6492.1A1", "X7042.1A1", "X7043.1A1", "X6493.1A1"],
                        ["RHD801281.25433-6095", "X6491.1A1", "X6492.1A1", "X7042.1A1", "X7043.1A1", "X6493.1A1"],
                        ["LHD801381.25433-0313", "X6408.1A1", "X6301.1A1", "X6409.1A1", "X6543.1A1"],
                        ["RHD801381.25433-0317", "X6301.1A1"],
                        ["RHD801381.25433-0317", "X6408.1A1", "X6409.1A1", "X6543.1A1"],
                        ["LHD801481.25433-0313", "X6408.1A1", "X6301.1A1", "X6409.1A1", "X6543.1A1"],
                        ["RHD801481.25433-0317", "X6301.1A1"],
                        ["RHD801481.25433-0317", "X6408.1A1", "X6409.1A1", "X6543.1A1"],
                        ["LHD802381.25433-0314", "X6302.1A1"],
                        ["LHD802381.25433-0315", "X6499.1A1", "X6478.1A1", "X6407.1A1", "X4556.1A1"],
                        ["LHD802381.25433-0315", "X6491.1A1", "X6492.1A1", "X7042.1A1", "X7043.1A1"],
                        ["LHD802381.25433-6095", "X6499.1A1", "X6478.1A1", "X6407.1A1", "X4556.1A1"],
                        ["LHD802381.25433-6095", "X6491.1A1", "X6492.1A1", "X7042.1A1", "X7043.1A1"],
                        ["RHD802381.25433-0319", "X6499.1A1", "X6478.1A1", "X6302.1A1", "X6407.1A1", "X4556.1A1"],
                        ["RHD802381.25433-0315", "X6499.1A1", "X6478.1A1", "X6407.1A1", "X4556.1A1"],
                        ["RHD802381.25433-6095", "X6499.1A1", "X6478.1A1", "X6407.1A1", "X4556.1A1"],
                        ["LHD802481.25433-0313", "X6301.1A1", "X6408.1A1", "X6409.1A1", "X6543.1A1"],
                        ["RHD802481.25433-0318", "X6301.1A1"],
                        ["RHD802481.25433-0318", "X6408.1A1", "X6409.1A1", "X6543.1A1"],
                        ["LHD802581.25433-0313", "X6499.1A1", "X6478.1A1", "X6407.1A1"],
                        ["LHD802581.25433-0315", "X6302.1A1", "X4556.1A1"],
                        ["LHD802581.25433-0316", "X6491.1A1", "X6492.1A1", "X7042.1A1", "X7043.1A1"],
                        ["LHD802581.25433-6095", "X6302.1A1", "X4556.1A1"],
                        ["LHD802581.25433-6096", "X6491.1A1", "X6492.1A1", "X7042.1A1", "X7043.1A1"],
                        ["RHD802581.25433-0313", "X6499.1A1", "X6302.1A1", "X6478.1A1", "X6407.1A1", "X4556.1A1"],
                        ["RHD802581.25433-0315", "X6491.1A1", "X6492.1A1", "X7042.1A1", "X7043.1A1"],
                        ["RHD802581.25433-6095", "X6491.1A1", "X6492.1A1", "X7042.1A1", "X7043.1A1"],
                        ["LHD802681.25433-0313", "X6408.1A1", "X6409.1A1", "X6301.1A1", "X6543.1A1"],
                        ["RHD802681.25433-0317", "X6301.1A1"],
                        ["RHD802681.25433-0317", "X6408.1A1", "X6409.1A1", "X6543.1A1"],
                        ["LHD804181.25433-0314", "X6499.1A1", "X6478.1A1", "X6407.1A1"],
                        ["LHD804181.25433-0315", "X6302.1A1", "X4556.1A1"],
                        ["LHD804181.25433-6095", "X6302.1A1", "X4556.1A1"],
                        ["LHD804181.25433-0316", "X6491.1A1", "X6492.1A1", "X7042.1A1", "X7043.1A1", "X6493.1A1"],
                        ["LHD804181.25433-6096", "X6491.1A1", "X6492.1A1", "X7042.1A1", "X7043.1A1", "X6493.1A1"],
                        ["LHD804281.25433-0313", "X6301.1A1", "X6408.1A1", "X6409.1A1", "X6543.1A1"]
                        ]
